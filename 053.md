J4de

high

# Bridge ERC20 does not check the token pair

## Summary

Bridge ERC20 did not check whether the local token corresponds to the remote token.

## Vulnerability Detail

```solidity
File: StandardBridge.sol
402     function _initiateBridgeERC20(
403         address _localToken,
404         address _remoteToken,
405         address _from,
406         address _to,
407         uint256 _amount,
408         uint32 _minGasLimit,
409         bytes memory _extraData
410     ) internal {
411         if (_isOptimismMintableERC20(_localToken)) {
412             require(
413                 _isCorrectTokenPair(_localToken, _remoteToken),
414                 "StandardBridge: wrong remote token for Optimism Mintable ERC20 local token"
415             );
416
417             OptimismMintableERC20(_localToken).burn(_from, _amount);
418         } else {
419             IERC20(_localToken).safeTransferFrom(_from, address(this), _amount);
420             deposits[_localToken][_remoteToken] = deposits[_localToken][_remoteToken] + _amount;
421         }
```

When `_localToken` is `OptimismMintableERC20`, call `_isCorrectTokenPair` to check the token pair. But when `_localToken` is not `OptimismMintableERC20`, the token pair is not checked.

## Impact

The attacker can first deploy a fake ERC20 token on local chain, use the fake token address as `_localToken`, and use the real token address on remote chain as `_remoteToken`, so that the fake token can be consumed on the local chain and the real token can be obtained on the remote chain.

## Code Snippet

https://github.com/ethereum-optimism/optimism/blob/9b9f78c6613c6ee53b93ca43c71bb74479f4b975/packages/contracts-bedrock/contracts/universal/StandardBridge.sol#L402-L421

## Tool used

Manual Review

## Recommendation

It is recommended to check the token pair.