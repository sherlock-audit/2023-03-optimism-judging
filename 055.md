J4de

high

# The `bridgeERC20` function of `StandardBridge.sol` may be used to bypass the `OptimismMintableERC20` judgment of `L2StandardBridge.sol`

## Summary

Both `StandardBridge.sol#bridgeERC20` and `L2StandardBridge.sol#withdraw` eventually call `_initiateBridgeERC20`, but `StandardBridge.sol#bridgeERC20` has less judgment.

## Vulnerability Detail

```solidity
File: L2StandardBridge.sol
179     function _initiateWithdrawal(
180         address _l2Token,
181         address _from,
182         address _to,
183         uint256 _amount,
184         uint32 _minGasLimit,
185         bytes memory _extraData
186     ) internal {
187         if (_l2Token == Predeploys.LEGACY_ERC20_ETH) {
188             _initiateBridgeETH(_from, _to, _amount, _minGasLimit, _extraData);
189         } else {
190 ->          address l1Token = OptimismMintableERC20(_l2Token).l1Token();
191             _initiateBridgeERC20(_l2Token, l1Token, _from, _to, _amount, _minGasLimit, _extraData);
192         }
193     }
```

When `L2StandardBridge.sol#_initiateWithdrawal` handles ERC20, the remote token address is obtained through `OptimismMintableERC20(_l2Token).l1Token()` and passed to `_initiateBridgeERC20`.

```solidity
File: StandardBridge.sol
231     function bridgeERC20(
232         address _localToken,
233         address _remoteToken,
234         uint256 _amount,
235         uint32 _minGasLimit,
236         bytes calldata _extraData
237     ) public virtual onlyEOA {
238         _initiateBridgeERC20(
239             _localToken,
240             _remoteToken,
241             msg.sender,
242             msg.sender,
243             _amount,
244             _minGasLimit,
245             _extraData
246         );
247     }
```

The problem is that when `bridgeERC20` handles ERC20, `_remoteToken` is completely controlled by the caller

## Impact

The attacker can pass in a fake `_localToken` and a real `_remoteToken` through `bridgeERC20`, bypassing the token pair judgment of `OptimismMintableERC20`. Finally, fake tokens can be consumed on L2 and real tokens can be obtained on L1.

## Code Snippet

https://github.com/ethereum-optimism/optimism/blob/9b9f78c6613c6ee53b93ca43c71bb74479f4b975/packages/contracts-bedrock/contracts/universal/StandardBridge.sol#L231-L247

## Tool used

Manual Review

## Recommendation

It is recommended to remove redundant interfaces or make consistent judgments.
